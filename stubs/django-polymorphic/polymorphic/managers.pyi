from collections.abc import Iterable
from typing import Any
from typing_extensions import Self, TypeVar

from django.db import models

from .query import PolymorphicQuerySet as PolymorphicQuerySet

__all__ = ["PolymorphicManager", "PolymorphicQuerySet"]

_T = TypeVar("_T", bound=models.Model, default=models.Model)

class PolymorphicManager(models.Manager[_T]):
    queryset_class: type[PolymorphicQuerySet[_T]]
    @classmethod
    def from_queryset(cls, queryset_class: type[models.query.QuerySet[_T, _T]], class_name: str | None = None) -> type[Self]: ...
    def get_queryset(self) -> PolymorphicQuerySet[_T]: ...
    def non_polymorphic(self) -> PolymorphicQuerySet[_T]: ...
    def instance_of(self, *args: type[models.Model]) -> PolymorphicQuerySet[_T]: ...
    def not_instance_of(self, *args: type[models.Model]) -> PolymorphicQuerySet[_T]: ...
    def get_real_instances(self, base_result_objects: Iterable[_T] | None = None) -> list[_T]: ...
    def create_from_super(self, obj: models.Model, **kwargs: Any) -> _T: ...
