import os
from collections.abc import Callable
from logging import Logger
from typing import Any
from urllib.parse import ParseResult

from .fileaware_mapping import FileAwareMapping

Openable = ...
logger: Logger

class NoValue: ...

# Some type aliases to make our life easier
_Str = str
_Bytes = bytes
_Bool = bool
_Int = int
_Float = float
_List = list
_Tuple = tuple
_Dict = dict

_Cast = Callable[[_Str], Any]
_Scheme = _Dict[_Str, _Cast | tuple[_Cast, Any]]
_BooleanTrueStrings = tuple[str, ...]

class Env:
    ENVIRON: _Dict[_Str, _Str]
    NOTSET: NoValue
    BOOLEAN_TRUE_STRINGS: _BooleanTrueStrings
    URL_CLASS = ParseResult
    POSTGRES_FAMILY: _List[_Str]
    DEFAULT_DATABASE_ENV: _Str = "DATABASE_URL"
    DB_SCHEMES: _Dict[_Str, _Str]
    DEFAULT_CACHE_ENV: _Str = "CACHE_URL"
    CACHE_SCHEMES: _Dict[_Str, _Str]
    DEFAULT_EMAIL_ENV: _Str = "EMAIL_URL"
    EMAIL_SCHEMES: _Dict[_Str, _Str]
    DEFAULT_SEARCH_ENV: _Str = "SEARCH_URL"
    SEARCH_SCHEMES: _Dict[_Str, _Str]
    ELASTICSEARCH_FAMILY: _List[_Str]
    CLOUDSQL: _Str
    DEFAULT_CHANNELS_ENV: _Str = "CHANNELS_URL"
    CHANNELS_SCHEMES: _Dict[_Str, _Str]
    smart_cast: _Bool
    escape_proxy: _Bool
    prefix: _Str
    scheme: _Scheme

    def __init__(self, **scheme: _Scheme) -> None: ...
    def __call__(
        self, var: _Str, cast: _Cast | None = None, default: Any | NoValue = NOTSET, parse_default: _Bool = False
    ) -> Any: ...
    def __contains__(self, var: _Str) -> _Bool: ...
    def str(self, var: _Str, default: _Str | NoValue = NOTSET, multiline: _Bool = False) -> _Str: ...
    def bytes(self, var: _Str, default: _Bytes | NoValue = NOTSET, encoding: _Str = "utf8") -> _Bytes: ...
    def bool(self, var: _Str, default: _Bool | NoValue = NOTSET) -> _Bool: ...
    def int(self, var: _Str, default: _Int | NoValue = NOTSET) -> _Int: ...
    def float(self, var: _Str, default: _Float | NoValue = NOTSET) -> _Float: ...
    def json(self, var: _Str, default: Any | NoValue = NOTSET) -> Any: ...
    def list(self, var: _Str, cast: _Cast | None = None, default: _List | NoValue = NOTSET) -> _List: ...
    def tuple(self, var: _Str, cast: _Cast | None = None, default: _Tuple | NoValue = NOTSET) -> _Tuple: ...
    def dict(self, var: _Str, cast: _Cast | None = None, default: _Dict | NoValue = NOTSET) -> _Dict: ...
    def url(self, var: _Str, default: _Str | NoValue = NOTSET) -> _Str: ...
    def db_url(self, var: _Str = DEFAULT_DATABASE_ENV, default: _Str | NoValue = NOTSET, engine: _Str | None = None) -> _Dict: ...

    db = db_url

    def cache_url(
        self, var: _Str = DEFAULT_CACHE_ENV, default: _Str | NoValue = NOTSET, backend: _Str | None = None
    ) -> _Dict: ...

    cache = cache_url

    def email_url(
        self, var: _Str = DEFAULT_EMAIL_ENV, default: _Str | NoValue = NOTSET, backend: _Str | None = None
    ) -> _Dict: ...

    email = email_url

    def search_url(
        self, var: _Str = DEFAULT_SEARCH_ENV, default: _Str | NoValue = NOTSET, engine: _Str | None = None
    ) -> _Dict: ...
    def channels_url(
        self, var: _Str = DEFAULT_CHANNELS_ENV, default: _Str | NoValue = NOTSET, backend: _Str | None = None
    ) -> _Dict: ...

    channels = channels_url

    def path(self, var: _Str, default: _Str | NoValue = NOTSET, **kwargs) -> Path: ...
    def get_value(
        self, var: _Str, cast: _Cast | None = None, default: Any | NoValue = NOTSET, parse_default: _Bool = False
    ) -> Any: ...
    @classmethod
    def parse_value(cls, value: _Str, cast: _Cast) -> Any: ...
    @classmethod
    def db_url_config(cls, url: _Str | ParseResult, engine: _Str | None = None) -> _Dict: ...
    @classmethod
    def cache_url_config(cls, url: _Str | ParseResult, backend: _Str | None = None) -> _Dict: ...
    @classmethod
    def email_url_config(cls, url: _Str | ParseResult, backend: _Str | None = None) -> _Dict: ...
    @classmethod
    def channels_url_config(cls, url: _Str | ParseResult, backend: _Str | None = None) -> _Dict: ...
    @classmethod
    def search_url_config(cls, url: _Str | ParseResult, engine: _Str | None = None) -> _Dict: ...
    @classmethod
    def read_env(
        cls,
        env_file: _Str | os.PathLike[_Str] | None = None,
        overwrite: _Bool = False,
        parse_comments: _Bool = False,
        encoding: _Str = "utf8",
        **overrides: _Dict[_Str, _Str],
    ) -> None: ...

class FileAwareEnv(Env):
    ENVIRON: FileAwareMapping

_AnyStr = str | bytes

class Path:
    def path(self, *paths, **kwargs): ...
    def file(self, name, *args, **kwargs): ...
    @property
    def root(self): ...

    __root__: _AnyStr

    def __init__(self, start="", *paths, **kwargs) -> None: ...
    def __call__(self, *paths, **kwargs): ...
    def __eq__(self, other): ...
    def __ne__(self, other): ...
    def __add__(self, other): ...
    def __sub__(self, other): ...
    def __invert__(self): ...
    def __contains__(self, item) -> bool: ...
    def __unicode__(self): ...
    def __getitem__(self, *args, **kwargs): ...
    def __fspath__(self): ...
    def rfind(self, *args, **kwargs): ...
    def find(self, *args, **kwargs): ...
