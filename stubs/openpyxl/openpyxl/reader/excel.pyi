from _typeshed import Incomplete, StrPath
from typing import IO
from typing_extensions import Final
from zipfile import ZipFile

from openpyxl.packaging.relationship import Relationship
from openpyxl.packaging.workbook import ChildSheet
from openpyxl.workbook.workbook import Workbook

SUPPORTED_FORMATS: Final = (".xlsx", ".xlsm", ".xltx", ".xltm")

class ExcelReader:
    archive: ZipFile
    valid_files: list[str]
    read_only: bool
    keep_vba: bool
    data_only: bool
    keep_links: bool
    shared_strings: list[str]
    def __init__(
        self, fn: StrPath | IO[bytes], read_only: bool = ..., keep_vba: bool = ..., data_only: bool = ..., keep_links: bool = ...
    ) -> None: ...
    package: Incomplete
    def read_manifest(self) -> None: ...
    def read_strings(self) -> None: ...
    parser: Incomplete
    wb: Incomplete
    def read_workbook(self) -> None: ...
    def read_properties(self) -> None: ...
    def read_theme(self) -> None: ...
    def read_chartsheet(self, sheet: ChildSheet, rel: Relationship) -> None: ...
    def read_worksheets(self) -> None: ...
    def read(self) -> None: ...

def load_workbook(
    filename: StrPath | IO[bytes], read_only: bool = ..., keep_vba=..., data_only: bool = ..., keep_links: bool = ...
) -> Workbook: ...
