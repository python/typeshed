import contextlib
from _typeshed import Incomplete
from collections.abc import Generator
from gzip import GzipFile
from urllib import request

UNICODE_SCHEME_RE: Incomplete
BYTES_SCHEME_RE: Incomplete
FILESYSTEM_ENCODING: Incomplete
HTTP_HEADERS: Incomplete

class StreamingGzipFile(GzipFile):
    fileobj_to_close: Incomplete
    def __init__(self, fileobj) -> None: ...
    def close(self) -> None: ...
    def seekable(self): ...

def iri_to_uri(url): ...
def path2url(path): ...
def url_is_absolute(url): ...
def get_url_attribute(element, attr_name, base_url, allow_relative: bool = False): ...
def get_url_tuple(url, base_url): ...
def url_join(base_url, url, allow_relative, context, context_args): ...
def get_link_attribute(element, attr_name, base_url): ...
def ensure_url(string): ...
def default_url_fetcher(url, timeout: int = 10, ssl_context=None, http_headers=None, allowed_protocols=None): ...
@contextlib.contextmanager
def select_source(
    guess=None,
    filename=None,
    url=None,
    file_obj=None,
    string=None,
    base_url=None,
    url_fetcher=None,
    check_css_mime_type: bool = False,
) -> Generator[Incomplete]: ...

class URLFetchingError(IOError): ...
class FatalURLFetchingError(BaseException): ...

class URLFetcher(request.OpenerDirector):
    def __init__(
        self,
        timeout: int = 10,
        ssl_context=None,
        http_headers=None,
        allowed_protocols=None,
        allow_redirects: bool = True,
        fail_on_errors: bool = False,
        **kwargs,
    ) -> None: ...
    def fetch(self, url, headers=None): ...
    def open(self, url, data=None, timeout=None): ...
    def __call__(self, url): ...

class URLFetcherResponse:
    url: Incomplete
    status: Incomplete
    headers: Incomplete
    def __init__(self, url, body=None, headers=None, status: str = "200 OK", **kwargs) -> None: ...
    def read(self, *args, **kwargs): ...
    def close(self) -> None: ...
    @property
    def path(self): ...
    @property
    def content_type(self): ...
    @property
    def charset(self): ...

@contextlib.contextmanager
def fetch(url_fetcher, url) -> Generator[Incomplete]: ...
